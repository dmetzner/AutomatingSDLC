{% extends 'Default/base.html.twig' %}

{% block head %}
  <link rel="stylesheet" href="{{ asset('css/'~theme()~'/index.css') }}" media="screen"/>
{% endblock %}

{% block body %}

  {% if not app.user %}
    {{ include('Index/welcome-section.html.twig') }}
  {% endif %}

  <div id="featuredPrograms">
    <h1>{{ "programs.featured"|trans({}, "catroweb") }}</h1>

    {% if featured|length > 0 %}
      {{ include('Index/featured_programs_carousel.html.twig',
        { 'carousel' :
          {
            'id' : 'feature-slider',
            'slideCount' : featured|length,
            'slides' : featured,
            'classes' : '',
            'controls' : true
          }
        }
      ) }}
    {% endif %}

  </div>

  {% if theme() == 'pocketgalaxy' %}

    <div id="submissions">
      <h1>{{ "programs.submitted"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

    <div id="sample">
      <h1>{{ "programs.sample"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

    <div id="related">
      <h1>{{ "programs.related"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

  {% else %}

    <div id="newest" style="display:none">
      <h1>{{ "programs.newest"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

    <div id="recommended" style="display:none">
      <h1>{{ "programs.recommended"|trans({}, "catroweb") }}
        <i id="help-button" class="help-icon fa fa-question-circle ml-1 catro-icon-button"
           data-toggle="tooltip" title="Help"
           data-help-title="{{ "indexPage.recommendedSection.info.title"|trans({}, "catroweb") }}"
           data-help-description="{{ "indexPage.recommendedSection.info.description"|trans({}, "catroweb") }}">
        </i>
      </h1>
      <div class="programs"></div>
    </div>

    <div id="mostDownloaded" style="display:none">
      <h1>{{ "programs.most.downloaded"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

    <div id="mostViewed" style="display:none">
      <h1>{{ "programs.most.viewed"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

    <div id="random" style="display:none">
      <h1>{{ "programs.random"|trans({}, "catroweb") }}</h1>
      <div class="programs"></div>
    </div>

  {% endif %}
{% endblock %}

{% block js %}

  <script src="{{ asset('compiled/js/Index.js') }}"></script>
  <script>
    {% if theme() == 'pocketgalaxy' %}
    let sample = new ProjectLoader('#sample', '{{ path('api_gamejam_sample_programs') }}?q=GalaxyGameJam')
    let submissions = new ProjectLoader('#submissions', '{{ path('api_gamejam_submissions') }}?q=GalaxyGameJam')
    let related = new ProjectLoader('#related', '{{ path('api_search_programs') }}?q=galaxy')

    sample.init()
    submissions.init()
    related.init()

    {% else %}
    let newest = new ProjectLoader('#newest', '{{ path('api_recent_programs') }}')
    let recommendedByPageId = {{ constant('App\\Catrobat\\RecommenderSystem\\RecommendedPageId::INDEX_PAGE') }};
    let recommended = new ProjectLoader('#recommended', '{{ path('api_recsys_general_projects') }}', undefined, recommendedByPageId)
    let mostDownloaded = new ProjectLoader('#mostDownloaded', '{{ path('api_most_downloaded_programs') }}')
    let mostViewed = new ProjectLoader('#mostViewed', '{{ path('api_most_viewed_programs') }}')
    let random = new ProjectLoader('#random', '{{ path('api_random_programs') }}')

    newest.init()
    recommended.init()
    mostDownloaded.init()
    mostViewed.init()
    random.init()

    {% endif %}

    let index_page = new Index("{{ "ok"|trans({}, "catroweb") }}", "{{ path('homepage_click_stats') }}", "{{ path('click_stats') }}")
    index_page.init()

  </script>
{% endblock %}
